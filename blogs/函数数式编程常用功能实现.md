---
title: å‡½æ•°å¼ç¼–ç¨‹å¸¸ç”¨åŠŸèƒ½å®žçŽ°
date: 2021-01-09
categories:
- ðŸ‘¨â€ðŸ’» ç¼–ç¨‹
tags:
- JavaScript
---
```JavaScript
const _ = {}

// eachéåŽ† ä¸è¿”å›žæ–°æ•°ç»„
_.each = (list, callback) => {
    if (Array.isArray(list)) {
        for (let index = 0; index < list.length; index++) {
            callback(list[index], index, list)
        }
    } else if (typeof callback == "function") {
        throw new Error("second argument should be a function")
    } else {
        throw new Error("second argument should be an Array")
    }
}

// mapéåŽ† è¿”å›žæ–°æ•°ç»„
_.map = (list, callback) => {
    const storage = []
    _.each(list, (item, index, list) => {
        storage.push(callback(item, index, list))
    })
    return storage
}

// filter ç­›é€‰è¿”å›žæ–°æ•°ç»„
_.filter = (list, callback) => {
    const storage = []
    _.each(list, (item, index, list) => {
        if (callback(item, index, list) == true) {
            storage.push(item)
        }
    })
    return storage
}

// from å°†ç±»æ•°ç»„è½¬åŒ–ä¸ºæ•°ç»„
// åªèƒ½ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼ï¼Œç®­å¤´å‡½æ•°çš„argumentså‘çˆ¶çº§ç»§æ‰¿ï¼Œæ²¡æœ‰è‡ªå·±çš„arguments
_.from = (...args) => {
    return args
}

// reduce ç´¯ç§¯
_.reduce = (list, callback, init) => {
    let acc = init || list.shift()
    // ç©ºæ•°ç»„ä¸ºå¯¹è±¡æ•…ä¸ºtrue
    // == å¼ºåˆ¶è½¬æ¢è§„åˆ™
    // NaNå’Œå…¶ä»–ä»»ä½•ç±»åž‹æ¯”è¾ƒæ°¸è¿œè¿”å›žfalse
    // Boolean å’Œå…¶ä»–ä»»ä½•ç±»åž‹æ¯”è¾ƒï¼ŒBoolean é¦–å…ˆè¢«è½¬æ¢ä¸º Number ç±»åž‹
    // Stringå’ŒNumberæ¯”è¾ƒï¼Œå…ˆå°†Stringè½¬æ¢ä¸ºNumberç±»åž‹
    // null == undefinedæ¯”è¾ƒç»“æžœæ˜¯trueï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œnullã€undefinedå’Œå…¶ä»–ä»»ä½•ç»“æžœçš„æ¯”è¾ƒå€¼éƒ½ä¸ºfalse
    // åŽŸå§‹ç±»åž‹å’Œå¼•ç”¨ç±»åž‹åšæ¯”è¾ƒæ—¶ï¼Œå¼•ç”¨ç±»åž‹ä¼šä¾ç…§ToPrimitiveè§„åˆ™è½¬æ¢ä¸ºåŽŸå§‹ç±»åž‹
    // ToPrimitiveè§„åˆ™ï¼Œæ˜¯å¼•ç”¨ç±»åž‹å‘åŽŸå§‹ç±»åž‹è½¬å˜çš„è§„åˆ™ï¼Œå®ƒéµå¾ªå…ˆvalueOfåŽtoStringçš„æ¨¡å¼æœŸæœ›å¾—åˆ°ä¸€ä¸ªåŽŸå§‹ç±»åž‹
    while (list.length) {
        acc = callback(acc, list.shift())
    }
    return acc
}

// reduceRight ä»Žå³ä¾§ç´¯ç§¯
_.reduceRight = (list, callback, init) => {
    let acc = init || list.pop()
    // ç©ºæ•°ç»„ä¸ºå¯¹è±¡æ•…ä¸ºtrue
    // == å¼ºåˆ¶è½¬æ¢è§„åˆ™
    // NaNå’Œå…¶ä»–ä»»ä½•ç±»åž‹æ¯”è¾ƒæ°¸è¿œè¿”å›žfalse
    // Boolean å’Œå…¶ä»–ä»»ä½•ç±»åž‹æ¯”è¾ƒï¼ŒBoolean é¦–å…ˆè¢«è½¬æ¢ä¸º Number ç±»åž‹
    // Stringå’ŒNumberæ¯”è¾ƒï¼Œå…ˆå°†Stringè½¬æ¢ä¸ºNumberç±»åž‹
    // null == undefinedæ¯”è¾ƒç»“æžœæ˜¯trueï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œnullã€undefinedå’Œå…¶ä»–ä»»ä½•ç»“æžœçš„æ¯”è¾ƒå€¼éƒ½ä¸ºfalse
    // åŽŸå§‹ç±»åž‹å’Œå¼•ç”¨ç±»åž‹åšæ¯”è¾ƒæ—¶ï¼Œå¼•ç”¨ç±»åž‹ä¼šä¾ç…§ToPrimitiveè§„åˆ™è½¬æ¢ä¸ºåŽŸå§‹ç±»åž‹
    // ToPrimitiveè§„åˆ™ï¼Œæ˜¯å¼•ç”¨ç±»åž‹å‘åŽŸå§‹ç±»åž‹è½¬å˜çš„è§„åˆ™ï¼Œå®ƒéµå¾ªå…ˆvalueOfåŽtoStringçš„æ¨¡å¼æœŸæœ›å¾—åˆ°ä¸€ä¸ªåŽŸå§‹ç±»åž‹
    while (list.length) {
        acc = callback(acc, list.pop())
    }
    return acc
}

// compese å‡½æ•°ç»„åˆ
_.compose = (fns) => {
    return (result) => {
        return _.reduceRight(fns, (acc, v) => {
            return v(acc)
        }, result)
    }
}

// partial åå‡½æ•° å¤šå‚æ•°åˆ†æ­¥è°ƒç”¨
_.partial = (fn, ...args) => {
    return (..._arg) => {
        return fn(...args, ..._arg);
    }
}

// cruuy å‡½æ•°æŸ¯é‡ŒåŒ– 
_.curry = fn =>
    judge = (...args) =>
        args.length === fn.length
            ? fn(...args)
            : (arg) => judge(...args, arg)
```
